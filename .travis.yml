dist: xenial # required for Python >= 3.7
language: python
matrix:
  include:
    - stage: test
      name: "Test 3.6"
      python: "3.6"
      services: docker
      before_install:
        - docker pull rasa/duckling
        - docker run -d -p 0.0.0.0:8000:8000 rasa/duckling
      install:
        - pip install -r requirements.txt
        - python setup.py install
      script: python3 setup.py test || python setup.py test
    - name: "Test 3.7"
      python: "3.7"
      services: docker
      before_install:
        - docker pull rasa/duckling
        - docker run -d -p 0.0.0.0:8000:8000 rasa/duckling
      install:
        - pip install -r requirements.txt
        - python setup.py install
      script: python3 setup.py test || python setup.py test
    - stage: deploy
      install: true
      script: skip
      deploy:
        provider: pypi
        user: "Nicolas_Drbs"
        password:
          secure: "MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA7CDy8SVr9payX/H0x9MgtdxJ5UrR/1KSem2tKSMvLppkSjItpF7Il5rxoAaMotPevhY3IT1PZxsojTADwR/JM8lk42mJY1hLcTCoRaa3LszEYlM1kso+qBI8bqGQVv96XN8ZLFSichf+jtYksL1DfJq4gXpBY2hgz3vOkE74MdUivtBSdw4wCJROnkJVPXRN7B7vPE0RJGN8aS0MOW09KOUf728p9jJY3lTtBMATpXCoE8wmjpVODbGYepCOsS0V8wQXRO5ZOeL1Tht5vg8GBhvAYbFs+aJDsLpRTxDvOVp/XO9IoxGXpNXiWrq7L6casmCsrJaTYM8E1wwTb2bAi825Y+5kSNL2/jEbbyusBiBPD4A6nQCoU/E0gHWeRlAVePvWrDv6b9w2qXn6uk03a26pHdjD5ZT3Nvb43IXoCwIRH0ijEb0wgN/CJlUDWEF5pDEGwi4WTV60mwHokINg7uIOAa7LT29vTpO3W3217SETBZxwB52CrZ5w7gaTVJ5Sdv8CWe24Yz9UFwDXsq9XwQnz6el3YLRT7N97cL50lt/swOJguCujxFkVlAHEbZPY/KoDvehIQuQR8pVyRzzdqnp9abEfeypsCosbw++T2UYy3nhrjrmevb/YNYjZbthgEQnyk9ZsikvwkYvivttM8UaTkTbSLJL2/pUZxeXWfXECAwEAAQ=="

stages:
  - test
  - deploy

after_success:
  - coveralls
